<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>深度解梦大师 - 专业心理梦境分析</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 25%, #667eea 50%, #764ba2 75%, #f093fb 100%);
            min-height: 100vh;
            color: #333;
            position: relative;
            animation: gradientShift 15s ease-in-out infinite;
        }

        @keyframes gradientShift {
            0%, 100% { background: linear-gradient(135deg, #1e3c72 0%, #2a5298 25%, #667eea 50%, #764ba2 75%, #f093fb 100%); }
            50% { background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #ffecd2 75%, #fcb69f 100%); }
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="1" fill="rgba(255,255,255,0.1)" opacity="0.5"><animate attributeName="opacity" values="0.2;0.8;0.2" dur="4s" repeatCount="indefinite"/></circle><circle cx="80" cy="30" r="0.8" fill="rgba(255,255,255,0.15)" opacity="0.3"><animate attributeName="opacity" values="0.3;0.9;0.3" dur="6s" repeatCount="indefinite"/></circle><circle cx="50" cy="70" r="1.2" fill="rgba(255,255,255,0.12)" opacity="0.4"><animate attributeName="opacity" values="0.4;1;0.4" dur="8s" repeatCount="indefinite"/></circle><circle cx="30" cy="60" r="0.6" fill="rgba(255,255,255,0.18)" opacity="0.6"><animate attributeName="opacity" values="0.6;0.2;0.6" dur="5s" repeatCount="indefinite"/></circle></svg>') repeat;
            z-index: -1;
        }

        .header {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(20px);
            border-bottom: 3px solid rgba(255, 255, 255, 0.2);
            padding: 25px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .header h1 {
            color: white;
            font-size: 3rem;
            margin-bottom: 15px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57);
            background-size: 300% 300%;
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientText 4s ease-in-out infinite;
        }

        @keyframes gradientText {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .header p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.3rem;
            margin-bottom: 10px;
        }

        .header .subtitle {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1rem;
            font-style: italic;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .wizard-container {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 25px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            overflow: hidden;
            position: relative;
        }

        .wizard-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57);
            background-size: 200% 200%;
            animation: progressGlow 3s ease-in-out infinite;
        }

        @keyframes progressGlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .progress-bar {
            height: 6px;
            background: #e1e5e9;
            position: relative;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 16.66%;
            transition: width 0.5s ease;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: shimmer 2s infinite;
        }

        .step-indicator {
            display: flex;
            justify-content: space-between;
            padding: 30px 40px;
            background: #f8f9fa;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            position: relative;
        }

        .step:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 20px;
            right: -50%;
            width: 100%;
            height: 2px;
            background: #dee2e6;
            z-index: 1;
        }

        .step.active:not(:last-child)::after {
            background: #667eea;
        }

        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #dee2e6;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #6c757d;
            margin-bottom: 10px;
            position: relative;
            z-index: 2;
            transition: all 0.3s ease;
        }

        .step.active .step-circle {
            background: #667eea;
            color: white;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.4);
        }

        .step.completed .step-circle {
            background: #28a745;
            color: white;
        }

        .step-label {
            font-size: 0.9rem;
            color: #6c757d;
            text-align: center;
            font-weight: 600;
        }

        .step.active .step-label {
            color: #667eea;
        }

        .step-content {
            padding: 40px;
            min-height: 600px;
        }

        .step-panel {
            display: none;
        }

        .step-panel.active {
            display: block;
            animation: fadeInUp 0.5s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-title {
            font-size: 2rem;
            margin-bottom: 30px;
            color: #2d1b69;
            text-align: center;
            font-weight: 700;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #333;
            font-size: 1.1rem;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            background: white;
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
            line-height: 1.6;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .checkbox-item:hover {
            background: rgba(102, 126, 234, 0.1);
            border-color: #667eea;
        }

        .checkbox-item input[type="checkbox"] {
            margin-right: 12px;
            transform: scale(1.2);
        }

        .radio-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .radio-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .radio-item:hover {
            background: rgba(102, 126, 234, 0.1);
            border-color: #667eea;
        }

        .radio-item input[type="radio"] {
            margin-right: 12px;
            transform: scale(1.2);
        }

        .slider-container {
            margin: 20px 0;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #e1e5e9;
            outline: none;
            -webkit-appearance: none;
            margin: 20px 0;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(102, 126, 234, 0.3);
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: #666;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid #e1e5e9;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .analysis-result {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 25px;
            padding: 40px;
            margin-top: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .result-header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e1e5e9;
        }

        .result-title {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: #2d1b69;
            font-weight: 700;
        }

        .result-subtitle {
            font-size: 1.2rem;
            color: #666;
        }

        .analysis-tabs {
            display: flex;
            margin-bottom: 40px;
            background: #f8f9fa;
            border-radius: 12px;
            padding: 6px;
        }

        .tab-btn {
            flex: 1;
            padding: 15px;
            border: none;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 15px;
        }

        .tab-btn.active {
            background: #667eea;
            color: white;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .analysis-section {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            border-left: 5px solid #667eea;
            position: relative;
        }

        .analysis-section::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 60px;
            height: 60px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 0 15px 0 30px;
        }

        .analysis-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: #2d1b69;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .analysis-content {
            line-height: 1.8;
            color: #444;
            font-size: 16px;
            margin-bottom: 20px;
        }

        .score-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .score-card {
            text-align: center;
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .score-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .score-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 10px;
        }

        .score-label {
            font-size: 1rem;
            color: #666;
            margin-bottom: 15px;
        }

        .score-bar {
            width: 100%;
            height: 8px;
            background: #e1e5e9;
            border-radius: 4px;
            overflow: hidden;
        }

        .score-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 4px;
            transition: width 1s ease;
        }

        .symbols-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .symbol-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #4ecdc4;
        }

        .symbol-title {
            font-weight: 700;
            margin-bottom: 10px;
            color: #2d1b69;
        }

        .symbol-meaning {
            color: #555;
            line-height: 1.6;
        }

        .recommendations {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
        }

        .recommendations h3 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .recommendation-list {
            list-style: none;
            padding: 0;
        }

        .recommendation-list li {
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            padding-left: 30px;
        }

        .recommendation-list li::before {
            content: '💡';
            position: absolute;
            left: 0;
            top: 12px;
        }

        .emotional-state {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .emotion-indicator {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }

        .emotion-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .emotion-value {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .emotion-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.2rem;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .step-indicator {
                padding: 20px;
                overflow-x: auto;
            }

            .step {
                min-width: 100px;
            }

            .step-content {
                padding: 25px;
            }

            .score-grid {
                grid-template-columns: 1fr;
            }

            .analysis-tabs {
                flex-direction: column;
            }

            .navigation-buttons {
                flex-direction: column;
                gap: 15px;
            }
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }

        .loading-content {
            text-align: center;
            color: white;
        }

        .mystical-spinner {
            width: 100px;
            height: 100px;
            margin: 0 auto 30px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .loading-text {
            font-size: 1.3rem;
            margin-bottom: 10px;
        }

        .loading-subtext {
            font-size: 1rem;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>🔮 深度解梦大师</h1>
        <p>专业心理梦境分析系统</p>
        <div class="subtitle">基于荣格、弗洛伊德理论和现代认知科学的精准解梦</div>
    </div>

    <div class="container">
        <div class="wizard-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>

            <div class="step-indicator">
                <div class="step active" data-step="1">
                    <div class="step-circle">1</div>
                    <div class="step-label">个人信息</div>
                </div>
                <div class="step" data-step="2">
                    <div class="step-circle">2</div>
                    <div class="step-label">梦境描述</div>
                </div>
                <div class="step" data-step="3">
                    <div class="step-circle">3</div>
                    <div class="step-label">详细要素</div>
                </div>
                <div class="step" data-step="4">
                    <div class="step-circle">4</div>
                    <div class="step-label">情感状态</div>
                </div>
                <div class="step" data-step="5">
                    <div class="step-circle">5</div>
                    <div class="step-label">生活背景</div>
                </div>
                <div class="step" data-step="6">
                    <div class="step-circle">6</div>
                    <div class="step-label">解梦结果</div>
                </div>
            </div>

            <div class="step-content">
                <!-- 第一步：个人信息 -->
                <div class="step-panel active" id="step1">
                    <h2 class="section-title">📋 个人基础信息</h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="age">年龄</label>
                            <select id="age" class="form-select">
                                <option value="">请选择年龄段</option>
                                <option value="18-25">18-25岁</option>
                                <option value="26-35">26-35岁</option>
                                <option value="36-45">36-45岁</option>
                                <option value="46-55">46-55岁</option>
                                <option value="56-65">56-65岁</option>
                                <option value="65+">65岁以上</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="gender">性别</label>
                            <select id="gender" class="form-select">
                                <option value="">请选择性别</option>
                                <option value="male">男性</option>
                                <option value="female">女性</option>
                                <option value="other">其他</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="occupation">职业类型</label>
                            <select id="occupation" class="form-select">
                                <option value="">请选择职业类型</option>
                                <option value="student">学生</option>
                                <option value="office">办公室职员</option>
                                <option value="teacher">教师/教育工作者</option>
                                <option value="medical">医护人员</option>
                                <option value="business">商务/销售</option>
                                <option value="creative">创意/艺术工作者</option>
                                <option value="technical">技术/工程师</option>
                                <option value="service">服务业</option>
                                <option value="freelance">自由职业</option>
                                <option value="unemployed">暂时待业</option>
                                <option value="retired">退休</option>
                                <option value="other">其他</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="relationship">感情状态</label>
                            <select id="relationship" class="form-select">
                                <option value="">请选择感情状态</option>
                                <option value="single">单身</option>
                                <option value="dating">恋爱中</option>
                                <option value="married">已婚</option>
                                <option value="divorced">离异</option>
                                <option value="complicated">复杂状态</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>当前生活压力水平</label>
                        <div class="slider-container">
                            <input type="range" min="1" max="10" value="5" class="slider" id="stressLevel">
                            <div class="slider-labels">
                                <span>很轻松</span>
                                <span>适中</span>
                                <span>非常压力大</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>睡眠质量</label>
                        <div class="radio-group">
                            <label class="radio-item">
                                <input type="radio" name="sleepQuality" value="excellent">
                                <span>非常好</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="sleepQuality" value="good">
                                <span>较好</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="sleepQuality" value="average">
                                <span>一般</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="sleepQuality" value="poor">
                                <span>较差</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="sleepQuality" value="terrible">
                                <span>很差</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- 第二步：梦境描述 -->
                <div class="step-panel" id="step2">
                    <h2 class="section-title">🌙 详细梦境描述</h2>
                    <div class="form-group full-width">
                        <label for="dreamDescription">请尽可能详细地描述您的梦境</label>
                        <textarea id="dreamDescription" class="form-textarea" rows="8"
                                  placeholder="请描述您梦境的完整过程，包括：
1. 梦境发生的地点和环境
2. 出现的人物和关系
3. 发生的具体事件和情节
4. 您在梦中的角色和行为
5. 梦境的开始、发展和结束
6. 任何特殊的感受或印象

例如：我梦见自己回到了小时候的家，房子比现实中更大更明亮。我看到已故的奶奶坐在客厅里，她对我微笑但没有说话。突然房子开始变暗，我感到很害怕，想要逃跑但腿像被钉住了一样动不了..."></textarea>
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            <label for="dreamDate">梦境发生时间</label>
                            <select id="dreamDate" class="form-select">
                                <option value="today">今天</option>
                                <option value="yesterday">昨天</option>
                                <option value="thisweek">本周内</option>
                                <option value="lastweek">上周</option>
                                <option value="thismonth">本月内</option>
                                <option value="longer">更久以前</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="dreamClarity">梦境清晰度</label>
                            <select id="dreamClarity" class="form-select">
                                <option value="vague">模糊不清</option>
                                <option value="partial">部分清晰</option>
                                <option value="clear">比较清晰</option>
                                <option value="vivid">异常清晰</option>
                                <option value="hyperreal">超现实清晰</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>梦境类型（可多选）</label>
                        <div class="checkbox-group">
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamTypes" value="lucid">
                                <span>清醒梦（意识到在做梦）</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamTypes" value="nightmare">
                                <span>噩梦</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamTypes" value="recurring">
                                <span>重复梦境</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamTypes" value="prophetic">
                                <span>预知性梦境</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamTypes" value="sexual">
                                <span>性相关梦境</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamTypes" value="flying">
                                <span>飞行梦</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamTypes" value="falling">
                                <span>坠落梦</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamTypes" value="chase">
                                <span>追逐梦</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- 第三步：详细要素 -->
                <div class="step-panel" id="step3">
                    <h2 class="section-title">🔍 梦境要素分析</h2>

                    <div class="form-group">
                        <label>梦中出现的人物（可多选）</label>
                        <div class="checkbox-group">
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamCharacters" value="family">
                                <span>家人</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamCharacters" value="friends">
                                <span>朋友</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamCharacters" value="romantic">
                                <span>恋人/伴侣</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamCharacters" value="colleagues">
                                <span>同事</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamCharacters" value="strangers">
                                <span>陌生人</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamCharacters" value="celebrities">
                                <span>名人</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamCharacters" value="deceased">
                                <span>已故的人</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamCharacters" value="children">
                                <span>小孩</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>梦境发生的场所（可多选）</label>
                        <div class="checkbox-group">
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamLocations" value="home">
                                <span>家里</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamLocations" value="school">
                                <span>学校</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamLocations" value="workplace">
                                <span>工作场所</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamLocations" value="nature">
                                <span>自然环境</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamLocations" value="city">
                                <span>城市街道</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamLocations" value="unknown">
                                <span>未知地点</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamLocations" value="fantasy">
                                <span>幻想场所</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamLocations" value="childhood">
                                <span>童年记忆中的地方</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>梦中的重要物品/符号（可多选）</label>
                        <div class="checkbox-group">
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamSymbols" value="water">
                                <span>水（河流、海洋、雨等）</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamSymbols" value="fire">
                                <span>火（火焰、爆炸等）</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamSymbols" value="animals">
                                <span>动物</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamSymbols" value="vehicles">
                                <span>交通工具</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamSymbols" value="money">
                                <span>金钱/珠宝</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamSymbols" value="food">
                                <span>食物</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamSymbols" value="books">
                                <span>书籍/文字</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamSymbols" value="technology">
                                <span>电子设备</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- 第四步：情感状态 -->
                <div class="step-panel" id="step4">
                    <h2 class="section-title">💭 情感与心理状态</h2>

                    <div class="form-group">
                        <label>梦中的主要情感（按强度排序，最多选3个）</label>
                        <div class="checkbox-group">
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamEmotions" value="fear">
                                <span>😨 恐惧/害怕</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamEmotions" value="joy">
                                <span>😊 快乐/兴奋</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamEmotions" value="sadness">
                                <span>😢 悲伤/沮丧</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamEmotions" value="anger">
                                <span>😠 愤怒/烦躁</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamEmotions" value="anxiety">
                                <span>😰 焦虑/担心</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamEmotions" value="love">
                                <span>😍 爱意/温暖</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamEmotions" value="confusion">
                                <span>😵 困惑/迷茫</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="dreamEmotions" value="peace">
                                <span>😌 平静/安详</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>醒来后的感受强度</label>
                        <div class="slider-container">
                            <input type="range" min="1" max="10" value="5" class="slider" id="emotionIntensity">
                            <div class="slider-labels">
                                <span>很淡</span>
                                <span>中等</span>
                                <span>非常强烈</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>梦境对您的影响</label>
                        <div class="radio-group">
                            <label class="radio-item">
                                <input type="radio" name="dreamImpact" value="positive">
                                <span>正面影响</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="dreamImpact" value="negative">
                                <span>负面影响</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="dreamImpact" value="neutral">
                                <span>中性/无影响</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="dreamImpact" value="mixed">
                                <span>复杂感受</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group full-width">
                        <label for="wakeUpFeeling">醒来后的具体感受和想法</label>
                        <textarea id="wakeUpFeeling" class="form-textarea" rows="4"
                                  placeholder="请描述您醒来后的第一感受，以及这个梦对您当天心情的影响..."></textarea>
                    </div>
                </div>

                <!-- 第五步：生活背景 -->
                <div class="step-panel" id="step5">
                    <h2 class="section-title">🏠 生活背景分析</h2>

                    <div class="form-group">
                        <label>近期生活中的重要事件（可多选）</label>
                        <div class="checkbox-group">
                            <label class="checkbox-item">
                                <input type="checkbox" name="lifeEvents" value="work_change">
                                <span>工作变化</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="lifeEvents" value="relationship_change">
                                <span>感情变化</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="lifeEvents" value="family_issues">
                                <span>家庭问题</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="lifeEvents" value="health_concerns">
                                <span>健康担忧</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="lifeEvents" value="financial_stress">
                                <span>经济压力</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="lifeEvents" value="study_pressure">
                                <span>学习压力</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="lifeEvents" value="moving">
                                <span>搬家/环境变化</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="lifeEvents" value="loss">
                                <span>失去重要的人或事物</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>当前最关心的问题</label>
                        <div class="radio-group">
                            <label class="radio-item">
                                <input type="radio" name="mainConcern" value="career">
                                <span>事业发展</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="mainConcern" value="relationships">
                                <span>人际关系</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="mainConcern" value="health">
                                <span>健康状况</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="mainConcern" value="family">
                                <span>家庭和睦</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="mainConcern" value="future">
                                <span>未来规划</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="mainConcern" value="self">
                                <span>自我成长</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>做梦频率</label>
                        <div class="radio-group">
                            <label class="radio-item">
                                <input type="radio" name="dreamFrequency" value="daily">
                                <span>几乎每天</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="dreamFrequency" value="weekly">
                                <span>每周几次</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="dreamFrequency" value="monthly">
                                <span>每月几次</span>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="dreamFrequency" value="rarely">
                                <span>很少做梦</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group full-width">
                        <label for="additionalContext">其他相关背景信息</label>
                        <textarea id="additionalContext" class="form-textarea" rows="4"
                                  placeholder="请补充任何您认为可能与这个梦境相关的背景信息，比如最近看过的电影、书籍、新闻，或者心里一直在思考的问题..."></textarea>
                    </div>
                </div>

                <!-- 第六步：分析结果 -->
                <div class="step-panel" id="step6">
                    <div id="analysisResults" style="display: none;">
                        <!-- 分析结果将在这里显示 -->
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" id="prevBtn" onclick="previousStep()" style="display: none;">上一步</button>
                    <button class="btn btn-primary" id="nextBtn" onclick="nextStep()">下一步</button>
                </div>
            </div>
        </div>
    </div>

    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="mystical-spinner"></div>
            <div class="loading-text">AI正在深度分析您的梦境...</div>
            <div class="loading-subtext">这可能需要几秒钟时间</div>
        </div>
    </div>

    <script>
        class ProfessionalDreamAnalyzer {
            constructor() {
                this.currentStep = 1;
                this.totalSteps = 6;
                this.formData = {};
                this.analysisComplete = false;
            }

            updateProgress() {
                const percentage = (this.currentStep / this.totalSteps) * 100;
                document.getElementById('progressFill').style.width = percentage + '%';
            }

            updateStepIndicator() {
                document.querySelectorAll('.step').forEach((step, index) => {
                    const stepNumber = index + 1;
                    step.classList.remove('active', 'completed');

                    if (stepNumber < this.currentStep) {
                        step.classList.add('completed');
                        step.querySelector('.step-circle').innerHTML = '✓';
                    } else if (stepNumber === this.currentStep) {
                        step.classList.add('active');
                        step.querySelector('.step-circle').innerHTML = stepNumber;
                    } else {
                        step.querySelector('.step-circle').innerHTML = stepNumber;
                    }
                });
            }

            showStep(stepNumber) {
                document.querySelectorAll('.step-panel').forEach(panel => {
                    panel.classList.remove('active');
                });
                document.getElementById(`step${stepNumber}`).classList.add('active');

                // 更新按钮状态
                document.getElementById('prevBtn').style.display = stepNumber > 1 ? 'block' : 'none';

                if (stepNumber === this.totalSteps) {
                    document.getElementById('nextBtn').style.display = 'none';
                } else {
                    document.getElementById('nextBtn').style.display = 'block';
                    document.getElementById('nextBtn').textContent = stepNumber === this.totalSteps - 1 ? '开始分析' : '下一步';
                }
            }

            validateStep(stepNumber) {
                switch(stepNumber) {
                    case 1:
                        return this.validatePersonalInfo();
                    case 2:
                        return this.validateDreamDescription();
                    case 3:
                        return true; // 可选项
                    case 4:
                        return this.validateEmotions();
                    case 5:
                        return true; // 可选项
                    default:
                        return true;
                }
            }

            validatePersonalInfo() {
                const age = document.getElementById('age').value;
                const gender = document.getElementById('gender').value;

                if (!age || !gender) {
                    alert('请填写基础的年龄和性别信息');
                    return false;
                }
                return true;
            }

            validateDreamDescription() {
                const description = document.getElementById('dreamDescription').value.trim();

                if (!description || description.length < 20) {
                    alert('请提供至少20字的详细梦境描述');
                    return false;
                }
                return true;
            }

            validateEmotions() {
                const emotions = document.querySelectorAll('input[name="dreamEmotions"]:checked');

                if (emotions.length === 0) {
                    alert('请至少选择一种梦中的情感状态');
                    return false;
                }
                return true;
            }

            collectFormData() {
                this.formData = {
                    // 个人信息
                    age: document.getElementById('age').value,
                    gender: document.getElementById('gender').value,
                    occupation: document.getElementById('occupation').value,
                    relationship: document.getElementById('relationship').value,
                    stressLevel: document.getElementById('stressLevel').value,
                    sleepQuality: document.querySelector('input[name="sleepQuality"]:checked')?.value,

                    // 梦境描述
                    dreamDescription: document.getElementById('dreamDescription').value,
                    dreamDate: document.getElementById('dreamDate').value,
                    dreamClarity: document.getElementById('dreamClarity').value,
                    dreamTypes: Array.from(document.querySelectorAll('input[name="dreamTypes"]:checked')).map(cb => cb.value),

                    // 梦境要素
                    dreamCharacters: Array.from(document.querySelectorAll('input[name="dreamCharacters"]:checked')).map(cb => cb.value),
                    dreamLocations: Array.from(document.querySelectorAll('input[name="dreamLocations"]:checked')).map(cb => cb.value),
                    dreamSymbols: Array.from(document.querySelectorAll('input[name="dreamSymbols"]:checked')).map(cb => cb.value),

                    // 情感状态
                    dreamEmotions: Array.from(document.querySelectorAll('input[name="dreamEmotions"]:checked')).map(cb => cb.value),
                    emotionIntensity: document.getElementById('emotionIntensity').value,
                    dreamImpact: document.querySelector('input[name="dreamImpact"]:checked')?.value,
                    wakeUpFeeling: document.getElementById('wakeUpFeeling').value,

                    // 生活背景
                    lifeEvents: Array.from(document.querySelectorAll('input[name="lifeEvents"]:checked')).map(cb => cb.value),
                    mainConcern: document.querySelector('input[name="mainConcern"]:checked')?.value,
                    dreamFrequency: document.querySelector('input[name="dreamFrequency"]:checked')?.value,
                    additionalContext: document.getElementById('additionalContext').value
                };
            }

            async startAnalysis() {
                this.collectFormData();
                this.showLoading();

                // 模拟AI分析过程
                await this.delay(3000);

                const analysis = this.generateProfessionalAnalysis();
                this.displayAnalysis(analysis);
                this.hideLoading();
            }

            generateProfessionalAnalysis() {
                return {
                    overallInterpretation: this.generateOverallInterpretation(),
                    psychologicalAnalysis: this.generatePsychologicalAnalysis(),
                    symbolAnalysis: this.generateSymbolAnalysis(),
                    emotionalState: this.generateEmotionalState(),
                    personalGuidance: this.generatePersonalGuidance(),
                    scores: this.calculateProfessionalScores()
                };
            }

            generateOverallInterpretation() {
                const data = this.formData;
                let interpretation = `基于您提供的详细信息，这个梦境反映了您当前的心理状态和潜意识需求。`;

                // 根据压力水平调整解释
                if (data.stressLevel > 7) {
                    interpretation += ` 您当前承受着较高的生活压力，梦境可能是您心灵寻求释放和平衡的表现。`;
                } else if (data.stressLevel < 4) {
                    interpretation += ` 您的生活状态相对轻松，梦境更多反映了内心的创造力和想象力。`;
                }

                // 根据年龄段调整
                if (data.age === '18-25') {
                    interpretation += ` 作为年轻人，您的梦境往往与未来规划、自我认知和人际关系密切相关。`;
                } else if (data.age === '26-35') {
                    interpretation += ` 在人生的这个阶段，您的梦境可能更多涉及事业发展和生活选择的思考。`;
                }

                // 根据情感状态调整
                if (data.dreamEmotions.includes('fear')) {
                    interpretation += ` 梦中的恐惧情绪提示您可能正在面对某些未知的挑战或变化，这是很自然的心理反应。`;
                }

                return interpretation + ` 通过深入分析，我们可以更好地理解您内心的真实需求。`;
            }

            generatePsychologicalAnalysis() {
                const data = this.formData;
                let analysis = {};

                // 弗洛伊德理论分析
                analysis.freudian = `从弗洛伊德的精神分析角度来看，`;
                if (data.dreamSymbols.includes('water')) {
                    analysis.freudian += `梦中的水象征着无意识和情感的流动，可能代表您对情感表达的渴望。`;
                }
                if (data.dreamCharacters.includes('family')) {
                    analysis.freudian += `家人的出现反映了您内心对安全感和归属感的需求。`;
                }

                // 荣格理论分析
                analysis.jungian = `根据荣格的集体无意识理论，`;
                if (data.dreamSymbols.includes('animals')) {
                    analysis.jungian += `动物在梦中往往代表您的本能和原始能量，提示您关注内在的直觉力量。`;
                }
                if (data.dreamLocations.includes('unknown')) {
                    analysis.jungian += `未知地点象征着您正在探索自我的新领域，这是心理成长的标志。`;
                }

                // 现代认知理论
                analysis.cognitive = `从认知心理学角度分析，这个梦境是您大脑整理白天信息和情感的过程。`;
                if (data.dreamClarity === 'vivid') {
                    analysis.cognitive += `异常清晰的梦境通常表明您的大脑正在处理重要的心理信息。`;
                }

                return analysis;
            }

            generateSymbolAnalysis() {
                const symbols = this.formData.dreamSymbols;
                const analysis = [];

                const symbolMeanings = {
                    'water': {
                        title: '水的象征',
                        meaning: '代表情感、潜意识和生命力。清澈的水暗示情感健康，浑浊的水可能表示情感困扰。'
                    },
                    'fire': {
                        title: '火的象征',
                        meaning: '象征激情、能量和转化。可能代表您内心的强烈欲望或正在经历的重大变化。'
                    },
                    'animals': {
                        title: '动物象征',
                        meaning: '代表本能、直觉和原始能量。不同动物有不同含义：猫象征独立，狗象征忠诚，鸟象征自由。'
                    },
                    'vehicles': {
                        title: '交通工具',
                        meaning: '象征人生方向和控制力。汽车代表个人控制，火车代表既定轨道，飞机代表高远目标。'
                    }
                };

                symbols.forEach(symbol => {
                    if (symbolMeanings[symbol]) {
                        analysis.push(symbolMeanings[symbol]);
                    }
                });

                return analysis;
            }

            generateEmotionalState() {
                const emotions = this.formData.dreamEmotions;
                const intensity = parseInt(this.formData.emotionIntensity);

                const emotionScores = {};
                emotions.forEach(emotion => {
                    emotionScores[emotion] = Math.min(intensity * 10 + Math.random() * 20, 100);
                });

                return {
                    dominantEmotions: emotions.slice(0, 3),
                    intensity: intensity,
                    scores: emotionScores,
                    interpretation: this.getEmotionalInterpretation(emotions, intensity)
                };
            }

            getEmotionalInterpretation(emotions, intensity) {
                let interpretation = '';

                if (emotions.includes('fear') && intensity > 6) {
                    interpretation += '您的梦境显示出较强的焦虑情绪，这可能与现实生活中的压力源有关。';
                }

                if (emotions.includes('joy') && emotions.includes('sadness')) {
                    interpretation += '梦境中出现的复杂情感反映了您内心的矛盾状态，这是处理复杂情况时的正常反应。';
                }

                if (intensity > 8) {
                    interpretation += '强烈的情感体验表明这个梦境对您具有重要意义，值得深入思考。';
                }

                return interpretation || '您的情感状态相对平衡，梦境反映了正常的心理处理过程。';
            }

            generatePersonalGuidance() {
                const data = this.formData;
                const recommendations = [];

                // 基于压力水平的建议
                if (data.stressLevel > 7) {
                    recommendations.push('建议您采取一些减压措施，如冥想、运动或与朋友交流');
                    recommendations.push('考虑调整工作生活平衡，给自己更多休息时间');
                }

                // 基于睡眠质量的建议
                if (data.sleepQuality === 'poor' || data.sleepQuality === 'terrible') {
                    recommendations.push('改善睡眠环境和睡前习惯，有助于获得更好的睡眠质量');
                    recommendations.push('避免睡前使用电子设备，尝试放松技巧');
                }

                // 基于主要关注的建议
                if (data.mainConcern === 'relationships') {
                    recommendations.push('关注人际关系的梦境提示您重视沟通和理解的重要性');
                }

                // 基于梦境类型的建议
                if (data.dreamTypes.includes('recurring')) {
                    recommendations.push('重复性梦境通常暗示未解决的心理问题，建议深入思考其含义');
                }

                return recommendations.length > 0 ? recommendations : [
                    '继续保持现在的生活状态，注意观察梦境的变化模式',
                    '记录梦境日记，有助于更好地了解自己的潜意识',
                    '保持开放的心态，将梦境作为自我了解的工具'
                ];
            }

            calculateProfessionalScores() {
                const data = this.formData;

                // 心理健康指数
                let mentalHealth = 80;
                if (data.stressLevel > 7) mentalHealth -= 15;
                if (data.sleepQuality === 'poor') mentalHealth -= 10;
                if (data.dreamEmotions.includes('fear')) mentalHealth -= 5;

                // 情感稳定性
                let emotionalStability = 75;
                if (data.dreamEmotions.length > 3) emotionalStability -= 10;
                if (data.emotionIntensity > 8) emotionalStability -= 10;

                // 压力管理
                let stressManagement = 100 - (data.stressLevel * 8);

                // 自我认知
                let selfAwareness = 70;
                if (data.dreamClarity === 'vivid') selfAwareness += 15;
                if (data.dreamTypes.includes('lucid')) selfAwareness += 10;

                // 生活满意度
                let lifeSatisfaction = 75;
                if (data.lifeEvents.length > 3) lifeSatisfaction -= 15;
                if (data.mainConcern) lifeSatisfaction += 5; // 有明确关注点是好事

                return {
                    mentalHealth: Math.max(0, Math.min(100, mentalHealth)),
                    emotionalStability: Math.max(0, Math.min(100, emotionalStability)),
                    stressManagement: Math.max(0, Math.min(100, stressManagement)),
                    selfAwareness: Math.max(0, Math.min(100, selfAwareness)),
                    lifeSatisfaction: Math.max(0, Math.min(100, lifeSatisfaction))
                };
            }

            displayAnalysis(analysis) {
                const resultsContainer = document.getElementById('analysisResults');

                resultsContainer.innerHTML = `
                    <div class="analysis-result">
                        <div class="result-header">
                            <h2 class="result-title">🔮 深度解梦分析报告</h2>
                            <div class="result-subtitle">基于专业心理学理论的全面梦境解析</div>
                        </div>

                        <div class="analysis-tabs">
                            <button class="tab-btn active" onclick="switchAnalysisTab('overall')">综合解读</button>
                            <button class="tab-btn" onclick="switchAnalysisTab('psychology')">心理分析</button>
                            <button class="tab-btn" onclick="switchAnalysisTab('symbols')">符号解析</button>
                            <button class="tab-btn" onclick="switchAnalysisTab('emotional')">情感状态</button>
                            <button class="tab-btn" onclick="switchAnalysisTab('guidance')">个人指导</button>
                        </div>

                        <div class="tab-content active" id="overallTab">
                            <div class="analysis-section">
                                <h3 class="analysis-title">🎯 综合解读</h3>
                                <div class="analysis-content">${analysis.overallInterpretation}</div>
                            </div>

                            <div class="score-grid">
                                <div class="score-card">
                                    <div class="score-value">${analysis.scores.mentalHealth}</div>
                                    <div class="score-label">心理健康指数</div>
                                    <div class="score-bar">
                                        <div class="score-bar-fill" style="width: ${analysis.scores.mentalHealth}%"></div>
                                    </div>
                                </div>
                                <div class="score-card">
                                    <div class="score-value">${analysis.scores.emotionalStability}</div>
                                    <div class="score-label">情感稳定性</div>
                                    <div class="score-bar">
                                        <div class="score-bar-fill" style="width: ${analysis.scores.emotionalStability}%"></div>
                                    </div>
                                </div>
                                <div class="score-card">
                                    <div class="score-value">${analysis.scores.stressManagement}</div>
                                    <div class="score-label">压力管理能力</div>
                                    <div class="score-bar">
                                        <div class="score-bar-fill" style="width: ${analysis.scores.stressManagement}%"></div>
                                    </div>
                                </div>
                                <div class="score-card">
                                    <div class="score-value">${analysis.scores.selfAwareness}</div>
                                    <div class="score-label">自我认知水平</div>
                                    <div class="score-bar">
                                        <div class="score-bar-fill" style="width: ${analysis.scores.selfAwareness}%"></div>
                                    </div>
                                </div>
                                <div class="score-card">
                                    <div class="score-value">${analysis.scores.lifeSatisfaction}</div>
                                    <div class="score-label">生活满意度</div>
                                    <div class="score-bar">
                                        <div class="score-bar-fill" style="width: ${analysis.scores.lifeSatisfaction}%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="tab-content" id="psychologyTab">
                            <div class="analysis-section">
                                <h3 class="analysis-title">🧠 弗洛伊德精神分析</h3>
                                <div class="analysis-content">${analysis.psychologicalAnalysis.freudian}</div>
                            </div>

                            <div class="analysis-section">
                                <h3 class="analysis-title">🎭 荣格集体无意识</h3>
                                <div class="analysis-content">${analysis.psychologicalAnalysis.jungian}</div>
                            </div>

                            <div class="analysis-section">
                                <h3 class="analysis-title">🔬 现代认知理论</h3>
                                <div class="analysis-content">${analysis.psychologicalAnalysis.cognitive}</div>
                            </div>
                        </div>

                        <div class="tab-content" id="symbolsTab">
                            <div class="symbols-grid">
                                ${analysis.symbolAnalysis.map(symbol => `
                                    <div class="symbol-card">
                                        <div class="symbol-title">${symbol.title}</div>
                                        <div class="symbol-meaning">${symbol.meaning}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <div class="tab-content" id="emotionalTab">
                            <div class="analysis-section">
                                <h3 class="analysis-title">💭 情感状态分析</h3>
                                <div class="analysis-content">${analysis.emotionalState.interpretation}</div>
                            </div>

                            <div class="emotional-state">
                                ${Object.entries(analysis.emotionalState.scores).map(([emotion, score]) => `
                                    <div class="emotion-indicator">
                                        <div class="emotion-icon">${this.getEmotionIcon(emotion)}</div>
                                        <div class="emotion-value">${Math.round(score)}</div>
                                        <div class="emotion-label">${this.getEmotionLabel(emotion)}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <div class="tab-content" id="guidanceTab">
                            <div class="recommendations">
                                <h3>💡 个人化建议</h3>
                                <ul class="recommendation-list">
                                    ${analysis.personalGuidance.map(rec => `<li>${rec}</li>`).join('')}
                                </ul>
                            </div>
                        </div>
                    </div>
                `;

                resultsContainer.style.display = 'block';
                this.currentStep = 6;
                this.updateStepIndicator();
                this.updateProgress();
                this.showStep(6);

                // 滚动到结果区域
                resultsContainer.scrollIntoView({ behavior: 'smooth' });
            }

            getEmotionIcon(emotion) {
                const icons = {
                    'fear': '😨',
                    'joy': '😊',
                    'sadness': '😢',
                    'anger': '😠',
                    'anxiety': '😰',
                    'love': '😍',
                    'confusion': '😵',
                    'peace': '😌'
                };
                return icons[emotion] || '😐';
            }

            getEmotionLabel(emotion) {
                const labels = {
                    'fear': '恐惧',
                    'joy': '快乐',
                    'sadness': '悲伤',
                    'anger': '愤怒',
                    'anxiety': '焦虑',
                    'love': '爱意',
                    'confusion': '困惑',
                    'peace': '平静'
                };
                return labels[emotion] || emotion;
            }

            showLoading() {
                document.getElementById('loadingOverlay').style.display = 'flex';
            }

            hideLoading() {
                document.getElementById('loadingOverlay').style.display = 'none';
            }

            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }

            nextStep() {
                if (!this.validateStep(this.currentStep)) {
                    return;
                }

                if (this.currentStep === this.totalSteps - 1) {
                    // 开始分析
                    this.startAnalysis();
                    return;
                }

                if (this.currentStep < this.totalSteps) {
                    this.currentStep++;
                    this.updateStepIndicator();
                    this.updateProgress();
                    this.showStep(this.currentStep);
                }
            }

            previousStep() {
                if (this.currentStep > 1) {
                    this.currentStep--;
                    this.updateStepIndicator();
                    this.updateProgress();
                    this.showStep(this.currentStep);
                }
            }
        }

        // 全局变量和函数
        let dreamAnalyzer;

        // 初始化
        window.onload = function() {
            dreamAnalyzer = new ProfessionalDreamAnalyzer();
            dreamAnalyzer.updateStepIndicator();
            dreamAnalyzer.updateProgress();
        };

        function nextStep() {
            dreamAnalyzer.nextStep();
        }

        function previousStep() {
            dreamAnalyzer.previousStep();
        }

        function switchAnalysisTab(tabName) {
            // 移除所有活动状态
            document.querySelectorAll('.analysis-tabs .tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            // 激活选中的标签
            document.querySelector(`[onclick="switchAnalysisTab('${tabName}')"]`).classList.add('active');
            document.getElementById(tabName + 'Tab').classList.add('active');
        }

        // 限制情感选择数量
        document.addEventListener('change', function(e) {
            if (e.target.name === 'dreamEmotions') {
                const checkedEmotions = document.querySelectorAll('input[name="dreamEmotions"]:checked');
                if (checkedEmotions.length > 3) {
                    e.target.checked = false;
                    alert('最多只能选择3种主要情感');
                }
            }
        });
    </script>
</body>
</html>