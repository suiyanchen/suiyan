<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIè§£æ¢¦å¸ˆ - æ¢ç´¢æ½œæ„è¯†çš„å¥¥ç§˜</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #2d1b69 0%, #11998e 50%, #38ef7d 100%);
            min-height: 100vh;
            color: #333;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="1" fill="rgba(255,255,255,0.1)" opacity="0.5"><animate attributeName="opacity" values="0.5;1;0.5" dur="3s" repeatCount="indefinite"/></circle><circle cx="80" cy="30" r="0.5" fill="rgba(255,255,255,0.2)" opacity="0.3"><animate attributeName="opacity" values="0.3;0.8;0.3" dur="4s" repeatCount="indefinite"/></circle><circle cx="50" cy="70" r="1.5" fill="rgba(255,255,255,0.15)" opacity="0.4"><animate attributeName="opacity" values="0.4;0.9;0.4" dur="5s" repeatCount="indefinite"/></circle></svg>') repeat;
            z-index: -1;
        }

        .header {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
            padding: 20px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header h1 {
            color: white;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradient 3s ease-in-out infinite;
        }

        @keyframes gradient {
            0%, 100% { filter: hue-rotate(0deg); }
            50% { filter: hue-rotate(90deg); }
        }

        .header p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.1rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .input-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        .input-section::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, transparent, rgba(142, 45, 226, 0.1), transparent);
            animation: rotate 6s linear infinite;
            z-index: -1;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .section-title {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: #2d1b69;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
        }

        .dream-input {
            width: 100%;
            min-height: 120px;
            padding: 20px;
            border: 2px solid #e1e5e9;
            border-radius: 15px;
            font-size: 16px;
            line-height: 1.6;
            resize: vertical;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .dream-input:focus {
            outline: none;
            border-color: #4ecdc4;
            box-shadow: 0 0 0 3px rgba(78, 205, 196, 0.2);
            background: white;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #555;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .select-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 16px;
            background: #f8f9fa;
            transition: all 0.3s ease;
        }

        .select-input:focus {
            outline: none;
            border-color: #4ecdc4;
            background: white;
        }

        .emotion-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .emotion-btn {
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 14px;
        }

        .emotion-btn:hover {
            border-color: #4ecdc4;
            background: rgba(78, 205, 196, 0.1);
        }

        .emotion-btn.selected {
            border-color: #4ecdc4;
            background: #4ecdc4;
            color: white;
        }

        .analyze-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
            position: relative;
            overflow: hidden;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .analyze-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .analyze-btn:hover::before {
            left: 100%;
        }

        .results-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .loading-state {
            text-align: center;
            padding: 60px 20px;
            display: none;
        }

        .mystical-loader {
            width: 80px;
            height: 80px;
            margin: 0 auto 30px;
            border: 3px solid rgba(78, 205, 196, 0.3);
            border-top: 3px solid #4ecdc4;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .empty-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .analysis-result {
            display: none;
        }

        .analysis-result.show {
            display: block;
            animation: fadeInUp 0.5s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result-tab {
            display: flex;
            margin-bottom: 30px;
            background: #f8f9fa;
            border-radius: 12px;
            padding: 4px;
        }

        .tab-btn {
            flex: 1;
            padding: 12px;
            border: none;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .tab-btn.active {
            background: #4ecdc4;
            color: white;
            box-shadow: 0 2px 8px rgba(78, 205, 196, 0.3);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .interpretation-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 5px solid #4ecdc4;
        }

        .interpretation-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: #2d1b69;
        }

        .interpretation-text {
            line-height: 1.7;
            color: #555;
            margin-bottom: 15px;
        }

        .dream-symbols {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .symbol-tag {
            background: #4ecdc4;
            color: white;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 14px;
            font-weight: 500;
        }

        .emotion-analysis {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .emotion-item {
            text-align: center;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 12px;
        }

        .emotion-score {
            font-size: 2rem;
            font-weight: 700;
            color: #4ecdc4;
            margin-bottom: 5px;
        }

        .emotion-label {
            font-size: 0.9rem;
            color: #666;
        }

        .progress-ring {
            width: 60px;
            height: 60px;
            margin: 0 auto 10px;
            transform: rotate(-90deg);
        }

        .progress-circle {
            fill: none;
            stroke: #e1e5e9;
            stroke-width: 4;
        }

        .progress-circle.filled {
            stroke: #4ecdc4;
            stroke-dasharray: 157;
            stroke-dashoffset: 157;
            animation: fillProgress 1s ease-out forwards;
        }

        @keyframes fillProgress {
            to {
                stroke-dashoffset: 0;
            }
        }

        .dream-diary-section {
            grid-column: 1 / -1;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            margin-top: 30px;
        }

        .diary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .diary-entry {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .diary-entry:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .diary-entry::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #4ecdc4, #667eea);
        }

        .diary-date {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 10px;
        }

        .diary-preview {
            font-weight: 600;
            margin-bottom: 10px;
            color: #333;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .diary-emotion {
            display: inline-block;
            background: #4ecdc4;
            color: white;
            padding: 4px 8px;
            border-radius: 10px;
            font-size: 12px;
        }

        .stats-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            text-align: center;
            padding: 20px;
            border-radius: 15px;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
                gap: 20px;
                padding: 20px 15px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .emotion-selector {
                grid-template-columns: repeat(3, 1fr);
            }

            .input-section, .results-section, .dream-diary-section {
                padding: 20px;
            }

            .stats-panel {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .floating-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .floating-symbol {
            position: absolute;
            font-size: 2rem;
            opacity: 0.1;
            animation: float 10s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(10deg); }
        }
    </style>
</head>
<body>
    <div class="floating-elements">
        <div class="floating-symbol" style="top: 10%; left: 10%; animation-delay: 0s;">ğŸŒ™</div>
        <div class="floating-symbol" style="top: 20%; right: 15%; animation-delay: 2s;">â­</div>
        <div class="floating-symbol" style="top: 60%; left: 5%; animation-delay: 4s;">ğŸ”®</div>
        <div class="floating-symbol" style="top: 80%; right: 10%; animation-delay: 6s;">âœ¨</div>
        <div class="floating-symbol" style="top: 40%; left: 80%; animation-delay: 1s;">ğŸŒŸ</div>
    </div>

    <div class="header">
        <h1>ğŸ”® AIè§£æ¢¦å¸ˆ</h1>
        <p>æ¢ç´¢æ½œæ„è¯†çš„å¥¥ç§˜ï¼Œè§£è¯»æ¢¦å¢ƒçš„æ·±å±‚å«ä¹‰</p>
    </div>

    <div class="container">
        <div class="input-section">
            <h2 class="section-title">ğŸ“– æè¿°ä½ çš„æ¢¦å¢ƒ</h2>

            <div class="form-group">
                <label for="dreamDescription">è¯·è¯¦ç»†æè¿°ä½ çš„æ¢¦å¢ƒï¼š</label>
                <textarea
                    id="dreamDescription"
                    class="dream-input"
                    placeholder="è¯·å°½å¯èƒ½è¯¦ç»†åœ°æè¿°ä½ çš„æ¢¦å¢ƒ...åŒ…æ‹¬æ¢¦ä¸­çš„äººç‰©ã€åœ°ç‚¹ã€æƒ…èŠ‚ã€æ„Ÿå—ç­‰ã€‚ä¾‹å¦‚ï¼šæˆ‘æ¢¦è§è‡ªå·±åœ¨ä¸€åº§å¤è€çš„åŸå ¡é‡Œï¼Œé‡åˆ°äº†ä¸€åªä¼šè¯´è¯çš„çŒ«...">
                </textarea>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="dreamType">æ¢¦å¢ƒç±»å‹ï¼š</label>
                    <select id="dreamType" class="select-input">
                        <option value="">é€‰æ‹©æ¢¦å¢ƒç±»å‹</option>
                        <option value="lucid">æ¸…é†’æ¢¦</option>
                        <option value="nightmare">å™©æ¢¦</option>
                        <option value="prophetic">é¢„çŸ¥æ¢¦</option>
                        <option value="recurring">é‡å¤æ¢¦</option>
                        <option value="healing">æ²»æ„ˆæ¢¦</option>
                        <option value="adventure">å†’é™©æ¢¦</option>
                        <option value="relationship">æƒ…æ„Ÿæ¢¦</option>
                        <option value="work">å·¥ä½œæ¢¦</option>
                        <option value="flying">é£è¡Œæ¢¦</option>
                        <option value="falling">å è½æ¢¦</option>
                        <option value="chase">è¿½é€æ¢¦</option>
                        <option value="death">æ­»äº¡æ¢¦</option>
                        <option value="animal">åŠ¨ç‰©æ¢¦</option>
                        <option value="water">æ°´ç›¸å…³æ¢¦</option>
                        <option value="fire">ç«ç›¸å…³æ¢¦</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="dreamClarity">æ¢¦å¢ƒæ¸…æ™°åº¦ï¼š</label>
                    <select id="dreamClarity" class="select-input">
                        <option value="vague">æ¨¡ç³Šä¸æ¸…</option>
                        <option value="partial">éƒ¨åˆ†æ¸…æ™°</option>
                        <option value="clear">æ¯”è¾ƒæ¸…æ™°</option>
                        <option value="vivid">éå¸¸æ¸…æ™°</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label>æ¢¦ä¸­çš„ä¸»è¦æƒ…æ„Ÿï¼š</label>
                <div class="emotion-selector">
                    <div class="emotion-btn" data-emotion="joy">ğŸ˜Š å¿«ä¹</div>
                    <div class="emotion-btn" data-emotion="fear">ğŸ˜¨ ææƒ§</div>
                    <div class="emotion-btn" data-emotion="sadness">ğŸ˜¢ æ‚²ä¼¤</div>
                    <div class="emotion-btn" data-emotion="anger">ğŸ˜  æ„¤æ€’</div>
                    <div class="emotion-btn" data-emotion="surprise">ğŸ˜² æƒŠè®¶</div>
                    <div class="emotion-btn" data-emotion="calm">ğŸ˜Œ å¹³é™</div>
                    <div class="emotion-btn" data-emotion="excitement">ğŸ¤© å…´å¥‹</div>
                    <div class="emotion-btn" data-emotion="confusion">ğŸ˜µ å›°æƒ‘</div>
                </div>
            </div>

            <button class="analyze-btn" onclick="analyzeDream()">
                ğŸ”® å¼€å§‹è§£æ¢¦åˆ†æ
            </button>
        </div>

        <div class="results-section">
            <h2 class="section-title">âœ¨ è§£æ¢¦ç»“æœ</h2>

            <div class="loading-state" id="loadingState">
                <div class="mystical-loader"></div>
                <p style="color: #666; font-size: 1.1rem;">AIè§£æ¢¦å¸ˆæ­£åœ¨åˆ†æä½ çš„æ½œæ„è¯†...</p>
            </div>

            <div class="empty-state" id="emptyState">
                <div class="empty-icon">ğŸŒ™</div>
                <p>è¯·æè¿°ä½ çš„æ¢¦å¢ƒï¼Œè®©AIä¸ºä½ è§£è¯»å…¶ä¸­çš„å¥¥ç§˜</p>
            </div>

            <div class="analysis-result" id="analysisResult">
                <div class="result-tab">
                    <button class="tab-btn active" onclick="switchTab('ai')">AIæ™ºèƒ½è§£æ</button>
                    <button class="tab-btn" onclick="switchTab('traditional')">ä¼ ç»Ÿè§£æ¢¦</button>
                    <button class="tab-btn" onclick="switchTab('psychology')">å¿ƒç†å­¦è§£è¯»</button>
                </div>

                <div class="tab-content active" id="aiTab">
                    <div class="interpretation-card">
                        <div class="interpretation-title">ğŸ¤– AIæ™ºèƒ½è§£æ</div>
                        <div class="interpretation-text" id="aiInterpretation">
                            åŸºäºç°ä»£å¿ƒç†å­¦å’Œå¤§æ•°æ®åˆ†æï¼Œæ‚¨çš„æ¢¦å¢ƒæ˜¾ç¤º...
                        </div>
                        <div class="dream-symbols" id="dreamSymbols">
                            <span class="symbol-tag">ç¬¦å·åˆ†æ</span>
                        </div>
                    </div>

                    <div class="emotion-analysis">
                        <div class="emotion-item">
                            <div class="emotion-score" id="positiveScore">85%</div>
                            <div class="emotion-label">æ­£é¢æƒ…ç»ª</div>
                        </div>
                        <div class="emotion-item">
                            <div class="emotion-score" id="stressScore">25%</div>
                            <div class="emotion-label">å‹åŠ›æŒ‡æ•°</div>
                        </div>
                        <div class="emotion-item">
                            <div class="emotion-score" id="mysteryScore">60%</div>
                            <div class="emotion-label">ç¥ç§˜æŒ‡æ•°</div>
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="traditionalTab">
                    <div class="interpretation-card">
                        <div class="interpretation-title">ğŸ“œ ä¼ ç»Ÿå‘¨å…¬è§£æ¢¦</div>
                        <div class="interpretation-text" id="traditionalInterpretation">
                            æ ¹æ®å¤ä»£å‘¨å…¬è§£æ¢¦çš„æ™ºæ…§...
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="psychologyTab">
                    <div class="interpretation-card">
                        <div class="interpretation-title">ğŸ§  ç°ä»£å¿ƒç†å­¦è§£è¯»</div>
                        <div class="interpretation-text" id="psychologyInterpretation">
                            ä»å¼—æ´›ä¼Šå¾·å’Œè£æ ¼çš„æ¢¦å¢ƒç†è®ºè§’åº¦åˆ†æ...
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="dream-diary-section">
            <h2 class="section-title">ğŸ“š æ¢¦å¢ƒæ—¥è®°</h2>

            <div class="stats-panel">
                <div class="stat-card">
                    <div class="stat-number" id="totalDreams">0</div>
                    <div class="stat-label">è®°å½•æ¢¦å¢ƒ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="happyDreams">0</div>
                    <div class="stat-label">å¿«ä¹æ¢¦å¢ƒ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="nightmares">0</div>
                    <div class="stat-label">å™©æ¢¦æ¬¡æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="lucidDreams">0</div>
                    <div class="stat-label">æ¸…é†’æ¢¦</div>
                </div>
            </div>

            <div id="diaryEmpty" class="empty-state" style="margin-top: 30px;">
                <div class="empty-icon">ğŸ“–</div>
                <p>è¿˜æ²¡æœ‰è®°å½•ä»»ä½•æ¢¦å¢ƒï¼Œå¼€å§‹ä½ çš„ç¬¬ä¸€æ¬¡è§£æ¢¦å§ï¼</p>
            </div>

            <div class="diary-grid" id="diaryGrid" style="display: none;">
                <!-- æ¢¦å¢ƒæ—¥è®°æ¡ç›®å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <script>
        class DreamAnalyzer {
            constructor() {
                this.dreamHistory = JSON.parse(localStorage.getItem('dreamHistory')) || [];
                this.selectedEmotion = null;
                this.symbols = {
                    'æ°´': 'è±¡å¾æƒ…æ„Ÿå’Œæ½œæ„è¯†',
                    'ç«': 'ä»£è¡¨æ¿€æƒ…å’Œèƒ½é‡',
                    'åŠ¨ç‰©': 'åæ˜ æœ¬èƒ½å’Œç›´è§‰',
                    'é£è¡Œ': 'å¯»æ±‚è‡ªç”±å’Œè¶…è¶Š',
                    'æ­»äº¡': 'è±¡å¾é‡ç”Ÿå’Œè½¬å˜',
                    'æˆ¿å­': 'ä»£è¡¨è‡ªæˆ‘å’Œå®‰å…¨æ„Ÿ',
                    'è¿½é€': 'é€ƒé¿ç°å®é—®é¢˜',
                    'è€ƒè¯•': 'è‡ªæˆ‘è¯„ä»·å’Œå‹åŠ›',
                    'äº²äºº': 'æƒ…æ„Ÿè”ç³»å’Œä¾æ‹',
                    'é»‘æš—': 'æœªçŸ¥å’Œææƒ§',
                    'å…‰æ˜': 'å¸Œæœ›å’Œæ™ºæ…§',
                    'å è½': 'å¤±æ§å’Œä¸å®‰å…¨æ„Ÿ'
                };

                this.traditionalMeanings = {
                    'æ°´': 'è´¢è¿äº¨é€šï¼Œæ„Ÿæƒ…é¡ºåˆ©',
                    'ç«': 'äº‹ä¸šå…´æ—ºï¼Œä½†éœ€é˜²å°äºº',
                    'è›‡': 'æœ‰è´µäººç›¸åŠ©ï¼Œè´¢è¿ä½³',
                    'é¾™': 'å¤§å‰å¤§åˆ©ï¼Œäº‹ä¸šæœ‰æˆ',
                    'çŒ«': 'å°å¿ƒè°¨æ…ï¼Œé˜²èŒƒå°äºº',
                    'ç‹—': 'æœ‹å‹è¿ä½³ï¼Œæœ‰è´µäºº',
                    'æ­»äº¡': 'é•¿å¯¿å¥åº·ï¼Œå¥½è¿æ¥ä¸´',
                    'é£è¡Œ': 'äº‹ä¸šè…¾é£ï¼Œå‰ç¨‹ä¼¼é”¦',
                    'æˆ¿å­': 'å®¶åº­å’Œç¦ï¼Œè´¢è¿æ—ºç››',
                    'è€ƒè¯•': 'å­¦ä¸šè¿›æ­¥ï¼Œå·¥ä½œé¡ºåˆ©'
                };

                this.psychologyMeanings = {
                    'æ°´': 'æ½œæ„è¯†æƒ…æ„Ÿçš„æµåŠ¨ï¼Œå¯èƒ½åæ˜ å†…å¿ƒçš„æƒ…æ„ŸçŠ¶æ€',
                    'ç«': 'æ¿€æƒ…å’Œèƒ½é‡çš„è±¡å¾ï¼Œå¯èƒ½ä»£è¡¨å¼ºçƒˆçš„æ¬²æœ›æˆ–æ„¤æ€’',
                    'é£è¡Œ': 'å¯¹è‡ªç”±çš„æ¸´æœ›ï¼Œæˆ–è€…æƒ³è¦æ‘†è„±ç°å®æŸç¼šçš„å¿ƒç†',
                    'è¿½é€': 'å¯èƒ½ä»£è¡¨é€ƒé¿ç°å®ä¸­çš„æŸäº›é—®é¢˜æˆ–è´£ä»»',
                    'æ­»äº¡': 'è±¡å¾ç”Ÿæ´»ä¸­æŸä¸ªé˜¶æ®µçš„ç»“æŸå’Œæ–°å¼€å§‹',
                    'åŠ¨ç‰©': 'æœ¬èƒ½å’ŒåŸå§‹æ¬²æœ›çš„ä½“ç°ï¼Œè¿æ¥å†…åœ¨é‡æ€§',
                    'æˆ¿å­': 'è‡ªæˆ‘æ„è¯†å’Œäººæ ¼ç»“æ„çš„è±¡å¾',
                    'è€ƒè¯•': 'è‡ªæˆ‘è¯„ä»·å’Œå¯¹èƒ½åŠ›çš„æ‹…å¿§'
                };

                this.init();
            }

            init() {
                this.bindEvents();
                this.updateStats();
                this.displayDreamHistory();
            }

            bindEvents() {
                // æƒ…æ„Ÿé€‰æ‹©å™¨äº‹ä»¶
                document.querySelectorAll('.emotion-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelectorAll('.emotion-btn').forEach(b => b.classList.remove('selected'));
                        e.target.classList.add('selected');
                        this.selectedEmotion = e.target.dataset.emotion;
                    });
                });
            }

            analyzeDream() {
                const description = document.getElementById('dreamDescription').value.trim();
                const dreamType = document.getElementById('dreamType').value;
                const clarity = document.getElementById('dreamClarity').value;

                if (!description) {
                    alert('è¯·å…ˆæè¿°ä½ çš„æ¢¦å¢ƒ');
                    return;
                }

                this.showLoading();

                // æ¨¡æ‹ŸAIåˆ†æè¿‡ç¨‹
                setTimeout(() => {
                    const analysis = this.generateAnalysis(description, dreamType, clarity);
                    this.displayAnalysis(analysis);
                    this.saveDreamToHistory(description, dreamType, clarity, analysis);
                    this.hideLoading();
                }, 2000);
            }

            generateAnalysis(description, dreamType, clarity) {
                const symbols = this.extractSymbols(description);
                const emotion = this.selectedEmotion || 'neutral';

                return {
                    aiInterpretation: this.generateAIInterpretation(description, symbols, emotion),
                    traditionalInterpretation: this.generateTraditionalInterpretation(symbols),
                    psychologyInterpretation: this.generatePsychologyInterpretation(symbols, emotion),
                    symbols: symbols,
                    emotionScores: this.calculateEmotionScores(emotion, dreamType),
                    dreamType: dreamType,
                    clarity: clarity
                };
            }

            extractSymbols(description) {
                const found = [];
                Object.keys(this.symbols).forEach(symbol => {
                    if (description.includes(symbol) ||
                        this.containsSimilarWord(description, symbol)) {
                        found.push(symbol);
                    }
                });
                return found.length > 0 ? found : ['ç¥ç§˜ç¬¦å·'];
            }

            containsSimilarWord(text, symbol) {
                const similarWords = {
                    'æ°´': ['æ²³', 'æµ·', 'æ¹–', 'é›¨', 'æ³ª', 'æ¸¸æ³³', 'æ´—æ¾¡', 'å–æ°´'],
                    'ç«': ['ç‡ƒçƒ§', 'çƒŸ', 'çƒ­', 'å¤ªé˜³', 'å…‰'],
                    'åŠ¨ç‰©': ['çŒ«', 'ç‹—', 'é¸Ÿ', 'é±¼', 'è›‡', 'é¾™', 'è™', 'ç‹¼'],
                    'é£è¡Œ': ['é£', 'å¤©ç©º', 'äº‘', 'ç¿…è†€'],
                    'æ­»äº¡': ['æ­»', 'å°¸ä½“', 'è‘¬ç¤¼', 'åŸå¢“'],
                    'æˆ¿å­': ['å®¶', 'é—¨', 'çª—', 'å±‹å­', 'å»ºç­‘'],
                    'è¿½é€': ['è·‘', 'é€ƒ', 'è¿½', 'èµ¶'],
                    'è€ƒè¯•': ['æµ‹è¯•', 'å­¦æ ¡', 'è€å¸ˆ', 'å­¦ä¹ ']
                };

                return similarWords[symbol]?.some(word => text.includes(word)) || false;
            }

            generateAIInterpretation(description, symbols, emotion) {
                const interpretations = [
                    `æ‚¨çš„æ¢¦å¢ƒæ˜¾ç¤ºäº†å†…å¿ƒæ·±å¤„çš„${emotion === 'fear' ? 'ææƒ§' : emotion === 'joy' ? 'å–œæ‚¦' : 'å¤æ‚æƒ…æ„Ÿ'}ã€‚`,
                    `æ¢¦ä¸­å‡ºç°çš„${symbols.join('ã€')}è±¡å¾ç€æ‚¨å½“å‰ç”Ÿæ´»çŠ¶æ€çš„åæ˜ ã€‚`,
                    `åŸºäºAIåˆ†æï¼Œè¿™ä¸ªæ¢¦å¢ƒå¯èƒ½é¢„ç¤ºç€æ‚¨å³å°†é¢ä¸´çš„å¿ƒç†å˜åŒ–ã€‚`,
                    `æ‚¨çš„æ½œæ„è¯†æ­£åœ¨é€šè¿‡è¿™ä¸ªæ¢¦å¢ƒä¼ è¾¾é‡è¦ä¿¡æ¯ï¼Œå»ºè®®æ‚¨å…³æ³¨å†…å¿ƒçš„å£°éŸ³ã€‚`,
                    `è¿™ä¸ªæ¢¦å¢ƒåæ˜ äº†æ‚¨å¯¹ç°å®ç”Ÿæ´»ä¸­æŸäº›æ–¹é¢çš„æ€è€ƒå’Œæ‹…å¿§ã€‚`
                ];

                return interpretations[Math.floor(Math.random() * interpretations.length)] +
                       ` æ¢¦å¢ƒçš„æ¸…æ™°åº¦è¡¨æ˜æ‚¨çš„æ½œæ„è¯†æ´»åŠ¨${description.length > 100 ? 'éå¸¸æ´»è·ƒ' : 'ç›¸å¯¹ç¨³å®š'}ã€‚`;
            }

            generateTraditionalInterpretation(symbols) {
                let interpretation = 'æ ¹æ®ä¼ ç»Ÿå‘¨å…¬è§£æ¢¦çš„æ™ºæ…§ï¼š';

                symbols.forEach(symbol => {
                    const meaning = this.traditionalMeanings[symbol];
                    if (meaning) {
                        interpretation += `${symbol}${meaning}ï¼›`;
                    }
                });

                if (interpretation === 'æ ¹æ®ä¼ ç»Ÿå‘¨å…¬è§£æ¢¦çš„æ™ºæ…§ï¼š') {
                    interpretation += 'æ­¤æ¢¦å¯“æ„å‰ç¥¥ï¼Œé¢„ç¤ºç€å¥½è¿å°†è‡³ï¼Œäº‹ä¸šé¡ºåˆ©ï¼Œå®¶åº­å’Œç¦ã€‚';
                }

                return interpretation;
            }

            generatePsychologyInterpretation(symbols, emotion) {
                let interpretation = 'ä»ç°ä»£å¿ƒç†å­¦è§’åº¦åˆ†æï¼š';

                symbols.forEach(symbol => {
                    const meaning = this.psychologyMeanings[symbol];
                    if (meaning) {
                        interpretation += `${meaning}ï¼›`;
                    }
                });

                const emotionAnalysis = {
                    'fear': 'æ‚¨å¯èƒ½æ­£åœ¨å¤„ç†ä¸€äº›å†…å¿ƒçš„ç„¦è™‘å’Œä¸å®‰',
                    'joy': 'æ‚¨çš„å¿ƒç†çŠ¶æ€è¾ƒä¸ºç§¯æï¼Œå¯¹ç”Ÿæ´»å……æ»¡å¸Œæœ›',
                    'sadness': 'æ‚¨å¯èƒ½éœ€è¦å¤„ç†ä¸€äº›æœªè§£å†³çš„æƒ…æ„Ÿé—®é¢˜',
                    'anger': 'æ‚¨å¯èƒ½å¯¹æŸäº›æƒ…å†µæ„Ÿåˆ°ä¸æ»¡æˆ–æŒ«æŠ˜',
                    'calm': 'æ‚¨çš„å¿ƒç†çŠ¶æ€ç›¸å¯¹å¹³é™ï¼Œå†…å¿ƒè¾ƒä¸ºå®‰å®š'
                };

                interpretation += ` ${emotionAnalysis[emotion] || 'æ‚¨çš„æƒ…æ„ŸçŠ¶æ€éœ€è¦è¿›ä¸€æ­¥å…³æ³¨å’Œç†è§£'}ã€‚`;

                return interpretation;
            }

            calculateEmotionScores(emotion, dreamType) {
                const baseScores = {
                    positive: Math.floor(Math.random() * 30) + 50,
                    stress: Math.floor(Math.random() * 40) + 20,
                    mystery: Math.floor(Math.random() * 50) + 30
                };

                // æ ¹æ®æƒ…æ„Ÿè°ƒæ•´åˆ†æ•°
                if (emotion === 'joy') {
                    baseScores.positive += 20;
                    baseScores.stress -= 10;
                } else if (emotion === 'fear') {
                    baseScores.positive -= 20;
                    baseScores.stress += 15;
                    baseScores.mystery += 10;
                }

                // æ ¹æ®æ¢¦å¢ƒç±»å‹è°ƒæ•´
                if (dreamType === 'nightmare') {
                    baseScores.stress += 20;
                    baseScores.mystery += 15;
                } else if (dreamType === 'lucid') {
                    baseScores.positive += 15;
                    baseScores.mystery += 20;
                }

                // ç¡®ä¿åˆ†æ•°åœ¨åˆç†èŒƒå›´å†…
                Object.keys(baseScores).forEach(key => {
                    baseScores[key] = Math.max(0, Math.min(100, baseScores[key]));
                });

                return baseScores;
            }

            displayAnalysis(analysis) {
                document.getElementById('aiInterpretation').textContent = analysis.aiInterpretation;
                document.getElementById('traditionalInterpretation').textContent = analysis.traditionalInterpretation;
                document.getElementById('psychologyInterpretation').textContent = analysis.psychologyInterpretation;

                // æ˜¾ç¤ºç¬¦å·
                const symbolsContainer = document.getElementById('dreamSymbols');
                symbolsContainer.innerHTML = '';
                analysis.symbols.forEach(symbol => {
                    const tag = document.createElement('span');
                    tag.className = 'symbol-tag';
                    tag.textContent = symbol;
                    symbolsContainer.appendChild(tag);
                });

                // æ˜¾ç¤ºæƒ…æ„Ÿåˆ†æ•°
                document.getElementById('positiveScore').textContent = analysis.emotionScores.positive + '%';
                document.getElementById('stressScore').textContent = analysis.emotionScores.stress + '%';
                document.getElementById('mysteryScore').textContent = analysis.emotionScores.mystery + '%';

                document.getElementById('emptyState').style.display = 'none';
                document.getElementById('analysisResult').classList.add('show');
            }

            saveDreamToHistory(description, dreamType, clarity, analysis) {
                const dreamEntry = {
                    id: Date.now(),
                    date: new Date().toLocaleDateString('zh-CN'),
                    description: description,
                    dreamType: dreamType,
                    clarity: clarity,
                    emotion: this.selectedEmotion,
                    analysis: analysis,
                    preview: description.substring(0, 50) + (description.length > 50 ? '...' : '')
                };

                this.dreamHistory.unshift(dreamEntry);

                // åªä¿ç•™æœ€è¿‘50ä¸ªæ¢¦å¢ƒè®°å½•
                if (this.dreamHistory.length > 50) {
                    this.dreamHistory = this.dreamHistory.slice(0, 50);
                }

                localStorage.setItem('dreamHistory', JSON.stringify(this.dreamHistory));
                this.updateStats();
                this.displayDreamHistory();
            }

            updateStats() {
                const total = this.dreamHistory.length;
                const happy = this.dreamHistory.filter(d => d.emotion === 'joy').length;
                const nightmares = this.dreamHistory.filter(d => d.dreamType === 'nightmare').length;
                const lucid = this.dreamHistory.filter(d => d.dreamType === 'lucid').length;

                document.getElementById('totalDreams').textContent = total;
                document.getElementById('happyDreams').textContent = happy;
                document.getElementById('nightmares').textContent = nightmares;
                document.getElementById('lucidDreams').textContent = lucid;
            }

            displayDreamHistory() {
                const diaryGrid = document.getElementById('diaryGrid');
                const diaryEmpty = document.getElementById('diaryEmpty');

                if (this.dreamHistory.length === 0) {
                    diaryEmpty.style.display = 'block';
                    diaryGrid.style.display = 'none';
                    return;
                }

                diaryEmpty.style.display = 'none';
                diaryGrid.style.display = 'grid';

                diaryGrid.innerHTML = '';

                this.dreamHistory.forEach(dream => {
                    const entry = document.createElement('div');
                    entry.className = 'diary-entry';
                    entry.innerHTML = `
                        <div class="diary-date">${dream.date}</div>
                        <div class="diary-preview">${dream.preview}</div>
                        <div class="diary-emotion">${this.getEmotionText(dream.emotion)}</div>
                    `;

                    entry.addEventListener('click', () => {
                        this.showDreamDetail(dream);
                    });

                    diaryGrid.appendChild(entry);
                });
            }

            getEmotionText(emotion) {
                const emotionMap = {
                    'joy': 'ğŸ˜Š å¿«ä¹',
                    'fear': 'ğŸ˜¨ ææƒ§',
                    'sadness': 'ğŸ˜¢ æ‚²ä¼¤',
                    'anger': 'ğŸ˜  æ„¤æ€’',
                    'surprise': 'ğŸ˜² æƒŠè®¶',
                    'calm': 'ğŸ˜Œ å¹³é™',
                    'excitement': 'ğŸ¤© å…´å¥‹',
                    'confusion': 'ğŸ˜µ å›°æƒ‘'
                };
                return emotionMap[emotion] || 'ğŸ˜ ä¸­æ€§';
            }

            showDreamDetail(dream) {
                // æ˜¾ç¤ºæ¢¦å¢ƒè¯¦æƒ…ï¼ˆå¯ä»¥è€ƒè™‘æ·»åŠ æ¨¡æ€æ¡†ï¼‰
                alert(`æ¢¦å¢ƒæ—¥æœŸï¼š${dream.date}\n\næ¢¦å¢ƒæè¿°ï¼š${dream.description}\n\nAIè§£æï¼š${dream.analysis.aiInterpretation}`);
            }

            showLoading() {
                document.getElementById('loadingState').style.display = 'block';
                document.getElementById('emptyState').style.display = 'none';
                document.getElementById('analysisResult').classList.remove('show');
            }

            hideLoading() {
                document.getElementById('loadingState').style.display = 'none';
            }
        }

        // å…¨å±€å‡½æ•°
        function analyzeDream() {
            dreamAnalyzer.analyzeDream();
        }

        function switchTab(tabName) {
            // ç§»é™¤æ‰€æœ‰æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            // æ¿€æ´»é€‰ä¸­çš„æ ‡ç­¾
            document.querySelector(`[onclick="switchTab('${tabName}')"]`).classList.add('active');
            document.getElementById(tabName + 'Tab').classList.add('active');
        }

        // åˆå§‹åŒ–åº”ç”¨
        const dreamAnalyzer = new DreamAnalyzer();
    </script>
</body>
</html>