<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸­æ–‡å–åç¥å™¨ - ä¸“ä¸šæ™ºèƒ½èµ·åå·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }

        .header {
            text-align: center;
            padding: 30px 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            font-size: 2.5rem;
            color: white;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.1rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .input-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            height: fit-content;
        }

        .section-title {
            font-size: 1.5rem;
            margin-bottom: 25px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .generate-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .generate-btn:active {
            transform: translateY(0);
        }

        .results-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .name-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .name-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            border: 2px solid transparent;
        }

        .name-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            border-color: #667eea;
        }

        .name-card.selected {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .name-text {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: #333;
        }

        .name-card.selected .name-text {
            color: white;
        }

        .name-score {
            font-size: 1.2rem;
            color: #667eea;
            margin-bottom: 10px;
        }

        .name-card.selected .name-score {
            color: rgba(255, 255, 255, 0.9);
        }

        .name-meaning {
            font-size: 0.9rem;
            color: #666;
            line-height: 1.4;
        }

        .name-card.selected .name-meaning {
            color: rgba(255, 255, 255, 0.8);
        }

        .favorite-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .favorite-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .favorite-btn.favorited {
            color: #ff6b6b;
        }

        .analysis-section {
            grid-column: 1 / -1;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }

        .analysis-content {
            display: none;
        }

        .analysis-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .analysis-item {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .analysis-item h4 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .analysis-value {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e1e5e9;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .favorites-section {
            grid-column: 1 / -1;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }

        .favorites-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .favorite-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            position: relative;
        }

        .favorite-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
        }

        .remove-favorite {
            position: absolute;
            top: 5px;
            right: 5px;
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            cursor: pointer;
        }

        .premium-notice {
            background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
        }

        .premium-notice h3 {
            margin-bottom: 10px;
        }

        .contact-info {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin-top: 30px;
            color: white;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
                gap: 20px;
                padding: 15px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .name-grid {
                grid-template-columns: 1fr;
            }

            .analysis-grid {
                grid-template-columns: 1fr;
            }

            .input-section, .results-section, .analysis-section, .favorites-section {
                padding: 20px;
            }
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .empty-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ‹ ä¸­æ–‡å–åç¥å™¨</h1>
        <p>åŸºäºä¼ ç»Ÿæ–‡åŒ–çš„æ™ºèƒ½èµ·åå·¥å…·ï¼Œä¸ºæ‚¨çš„å®å®å–ä¸€ä¸ªå¥½åå­—</p>
    </div>

    <div class="container">
        <div class="input-section">
            <h2 class="section-title">ğŸ“ åŸºæœ¬ä¿¡æ¯</h2>

            <div class="form-group">
                <label for="surname">å§“æ° *</label>
                <input type="text" id="surname" placeholder="è¯·è¾“å…¥å§“æ°" maxlength="2" required>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="gender">æ€§åˆ«</label>
                    <select id="gender">
                        <option value="male">ç”·å­©</option>
                        <option value="female">å¥³å­©</option>
                        <option value="neutral">ä¸­æ€§</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="nameLength">åå­—é•¿åº¦</label>
                    <select id="nameLength">
                        <option value="1">å•å­—å</option>
                        <option value="2" selected>åŒå­—å</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="birthYear">å‡ºç”Ÿå¹´ä»½</label>
                    <select id="birthYear">
                        <option value="">é€‰æ‹©å¹´ä»½</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="zodiac">ç”Ÿè‚–</label>
                    <select id="zodiac">
                        <option value="">è‡ªåŠ¨åˆ¤æ–­</option>
                        <option value="é¼ ">é¼ </option>
                        <option value="ç‰›">ç‰›</option>
                        <option value="è™">è™</option>
                        <option value="å…”">å…”</option>
                        <option value="é¾™">é¾™</option>
                        <option value="è›‡">è›‡</option>
                        <option value="é©¬">é©¬</option>
                        <option value="ç¾Š">ç¾Š</option>
                        <option value="çŒ´">çŒ´</option>
                        <option value="é¸¡">é¸¡</option>
                        <option value="ç‹—">ç‹—</option>
                        <option value="çŒª">çŒª</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label for="preferences">æœŸæœ›å¯“æ„</label>
                <select id="preferences">
                    <option value="">éšæœºç”Ÿæˆ</option>
                    <option value="intelligent">èªæ˜æ™ºæ…§</option>
                    <option value="brave">å‹‡æ•¢åšå¼º</option>
                    <option value="gentle">æ¸©å’Œå–„è‰¯</option>
                    <option value="beautiful">ç¾ä¸½ä¼˜é›…</option>
                    <option value="successful">äº‹ä¸šæœ‰æˆ</option>
                    <option value="healthy">å¥åº·å¹³å®‰</option>
                    <option value="noble">é«˜è´µå…¸é›…</option>
                    <option value="creative">å¯Œæœ‰åˆ›æ„</option>
                </select>
            </div>

            <button class="generate-btn" onclick="generateNames()">
                ğŸ¯ æ™ºèƒ½ç”Ÿæˆåå­—
            </button>

            <div class="premium-notice">
                <h3>ğŸ’ ä¸“ä¸šå–åæœåŠ¡</h3>
                <p>éœ€è¦æ›´ä¸“ä¸šçš„å–åå’¨è¯¢ï¼Ÿ<br>è”ç³»æˆ‘ä»¬è·å¾—ä¸€å¯¹ä¸€èµ·åæœåŠ¡</p>
            </div>
        </div>

        <div class="results-section">
            <h2 class="section-title">âœ¨ æ¨èåå­—</h2>

            <div id="loadingState" class="loading" style="display: none;">
                <div class="spinner"></div>
                <p>æ­£åœ¨ä¸ºæ‚¨ç²¾å¿ƒæŒ‘é€‰å¥½åå­—...</p>
            </div>

            <div id="emptyState" class="empty-state">
                <div class="empty-icon">ğŸ‹</div>
                <p>è¯·å¡«å†™åŸºæœ¬ä¿¡æ¯ï¼Œç‚¹å‡»ç”Ÿæˆåå­—</p>
            </div>

            <div id="nameResults" class="name-grid" style="display: none;"></div>
        </div>

        <div class="analysis-section">
            <h2 class="section-title">ğŸ“Š åå­—è¯¦ç»†è§£æ</h2>

            <div id="analysisContent" class="analysis-content">
                <div class="analysis-grid">
                    <div class="analysis-item">
                        <h4>ç»¼åˆè¯„åˆ†</h4>
                        <div class="analysis-value" id="totalScore">--</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="totalProgress" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="analysis-item">
                        <h4>éŸ³å¾‹ç¾æ„Ÿ</h4>
                        <div class="analysis-value" id="soundScore">--</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="soundProgress" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="analysis-item">
                        <h4>å¯“æ„å†…æ¶µ</h4>
                        <div class="analysis-value" id="meaningScore">--</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="meaningProgress" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="analysis-item">
                        <h4>äº”è¡ŒåŒ¹é…</h4>
                        <div class="analysis-value" id="elementScore">--</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="elementProgress" style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 12px;">
                    <h4 style="color: #667eea; margin-bottom: 15px;">ğŸ“œ åå­—é‡Šä¹‰</h4>
                    <div id="nameExplanation">é€‰æ‹©ä¸€ä¸ªåå­—æŸ¥çœ‹è¯¦ç»†é‡Šä¹‰</div>
                </div>
            </div>
        </div>

        <div class="favorites-section">
            <h2 class="section-title">â¤ï¸ æ”¶è—çš„åå­—</h2>

            <div id="favoritesEmpty" class="empty-state">
                <div class="empty-icon">ğŸ’</div>
                <p>æš‚æ— æ”¶è—çš„åå­—ï¼Œç‚¹å‡»åå­—å¡ç‰‡å³ä¸Šè§’çš„å¿ƒå½¢å›¾æ ‡æ”¶è—</p>
            </div>

            <div id="favoritesGrid" class="favorites-grid" style="display: none;"></div>
        </div>
    </div>

    <div class="contact-info">
        <h3>ğŸ“ ä¸“ä¸šå–åå’¨è¯¢</h3>
        <p>å¾®ä¿¡ï¼šyour_wechat_id | ç”µè¯ï¼š138-0000-0000</p>
        <p>ğŸ ä¸“ä¸šèµ·åå¸ˆä¸€å¯¹ä¸€æœåŠ¡ï¼Œæ»¡æ„ä¸ºæ­¢</p>
    </div>

    <script>
        // æ•°æ®åº“
        const nameDatabase = {
            male: {
                first: ['å¿—', 'å', 'æ˜', 'ä¼Ÿ', 'å¼º', 'å†›', 'æ–‡', 'å¾·', 'å‹‡', 'å»º', 'å›½', 'æµ·', 'å±±', 'å¤©', 'æ­£', 'æ°¸', 'é¾™', 'äº‘', 'åš', 'å®‡'],
                second: ['å¼º', 'å', 'å†›', 'ä¼Ÿ', 'æ˜', 'å³°', 'æ°', 'è¾‰', 'é¹', 'æ¶›', 'ç£Š', 'è¶…', 'é£', 'å®‡', 'é¾™', 'æ–Œ', 'åˆš', 'äº®', 'å½¬', 'æ£®']
            },
            female: {
                first: ['ç¾', 'é›…', 'ä¸½', 'é™', 'å¨Ÿ', 'ç§€', 'æ…§', 'æ•', 'èŠ³', 'ç²', 'ç‡•', 'çº¢', 'éœ', 'ç³', 'å©·', 'è', 'å€©', 'è“‰', 'è‰', 'æ´'],
                second: ['ä¸½', 'å', 'é›…', 'é™', 'ç‡•', 'ç³', 'è', 'éœ', 'å¨Ÿ', 'èŠ³', 'ç²', 'æ•', 'å©·', 'çº¢', 'å€©', 'è“‰', 'æ´', 'è‰', 'é¢–', 'æ…§']
            },
            neutral: {
                first: ['å®‰', 'ä¹', 'å¹³', 'å’Œ', 'åº·', 'å®', 'æ³½', 'ç‘', 'ç¥¥', 'ç¦', 'å˜‰', 'æ‚¦', 'æ¬£', 'çª', 'ç‘¶', 'æ™¨', 'é˜³', 'é›¨', 'æ—', 'è‹¥'],
                second: ['å®‰', 'ä¹', 'åº·', 'å®', 'ç¥¥', 'ç‘', 'æ³½', 'å˜‰', 'æ‚¦', 'æ¬£', 'çª', 'ç‘¶', 'æ™¨', 'é˜³', 'é›¨', 'æ—', 'è‹¥', 'ç„¶', 'ä¹‹', 'è¨€']
            }
        };

        const meanings = {
            'å¿—': 'å¿—å‘ã€ç†æƒ³',
            'å': 'å…‰å½©ã€æ‰å',
            'æ˜': 'å…‰æ˜ã€èªæ˜',
            'ä¼Ÿ': 'ä¼Ÿå¤§ã€å®ä¼Ÿ',
            'å¼º': 'å¼ºå£®ã€åšå¼º',
            'ç¾': 'ç¾ä¸½ã€ç¾å¥½',
            'é›…': 'ä¼˜é›…ã€æ–‡é›…',
            'ä¸½': 'ç¾ä¸½ã€ç§€ä¸½',
            'é™': 'å®‰é™ã€æ–‡é™',
            'æ…§': 'æ™ºæ…§ã€èªæ…§',
            'å®‰': 'å¹³å®‰ã€å®‰å®',
            'ä¹': 'å¿«ä¹ã€å–œæ‚¦',
            'å¹³': 'å¹³å®‰ã€å’Œå¹³',
            'å’Œ': 'å’Œè°ã€æ¸©å’Œ',
            'åº·': 'å¥åº·ã€å®‰åº·'
        };

        const elements = ['é‡‘', 'æœ¨', 'æ°´', 'ç«', 'åœŸ'];
        const zodiacYears = {
            2024: 'é¾™', 2023: 'å…”', 2022: 'è™', 2021: 'ç‰›', 2020: 'é¼ ',
            2019: 'çŒª', 2018: 'ç‹—', 2017: 'é¸¡', 2016: 'çŒ´', 2015: 'ç¾Š',
            2014: 'é©¬', 2013: 'è›‡', 2012: 'é¾™', 2011: 'å…”', 2010: 'è™'
        };

        let favorites = JSON.parse(localStorage.getItem('favoriteNames')) || [];
        let selectedNameCard = null;

        // åˆå§‹åŒ–
        window.onload = function() {
            initializeYearOptions();
            updateFavoritesDisplay();
        };

        function initializeYearOptions() {
            const yearSelect = document.getElementById('birthYear');
            const currentYear = new Date().getFullYear();

            for (let year = currentYear; year >= currentYear - 50; year--) {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year + 'å¹´';
                yearSelect.appendChild(option);
            }
        }

        function generateNames() {
            const surname = document.getElementById('surname').value.trim();
            if (!surname) {
                alert('è¯·è¾“å…¥å§“æ°');
                return;
            }

            const gender = document.getElementById('gender').value;
            const nameLength = parseInt(document.getElementById('nameLength').value);
            const birthYear = document.getElementById('birthYear').value;
            const preferences = document.getElementById('preferences').value;

            showLoading();

            setTimeout(() => {
                const names = generateNameList(surname, gender, nameLength, birthYear, preferences);
                displayNames(names);
                hideLoading();
            }, 1500);
        }

        function generateNameList(surname, gender, nameLength, birthYear, preferences) {
            const names = [];
            const database = nameDatabase[gender] || nameDatabase.neutral;

            for (let i = 0; i < 6; i++) {
                let name = surname;

                if (nameLength === 1) {
                    const char = database.first[Math.floor(Math.random() * database.first.length)];
                    name += char;
                } else {
                    const firstChar = database.first[Math.floor(Math.random() * database.first.length)];
                    const secondChar = database.second[Math.floor(Math.random() * database.second.length)];
                    name += firstChar + secondChar;
                }

                const analysis = analyzeNameScore(name, gender, birthYear);

                names.push({
                    fullName: name,
                    score: analysis.total,
                    meaning: generateMeaning(name.substr(1)),
                    analysis: analysis
                });
            }

            return names.sort((a, b) => b.score - a.score);
        }

        function analyzeNameScore(name, gender, birthYear) {
            const soundScore = Math.floor(Math.random() * 30) + 70;
            const meaningScore = Math.floor(Math.random() * 25) + 75;
            const elementScore = Math.floor(Math.random() * 20) + 80;
            const total = Math.floor((soundScore + meaningScore + elementScore) / 3);

            return {
                total: total,
                sound: soundScore,
                meaning: meaningScore,
                element: elementScore
            };
        }

        function generateMeaning(nameChars) {
            let meaning = '';
            for (let char of nameChars) {
                if (meanings[char]) {
                    meaning += meanings[char] + 'ï¼Œ';
                }
            }
            return meaning.slice(0, -1) || 'å¯“æ„ç¾å¥½ï¼Œå‰ç¨‹ä¼¼é”¦';
        }

        function displayNames(names) {
            const resultsContainer = document.getElementById('nameResults');
            const emptyState = document.getElementById('emptyState');

            resultsContainer.innerHTML = '';

            names.forEach((nameData, index) => {
                const nameCard = document.createElement('div');
                nameCard.className = 'name-card';
                nameCard.dataset.index = index;

                const isFavorited = favorites.some(fav => fav.fullName === nameData.fullName);

                nameCard.innerHTML = `
                    <button class="favorite-btn ${isFavorited ? 'favorited' : ''}" onclick="toggleFavorite(event, ${index})">
                        ${isFavorited ? 'â¤ï¸' : 'ğŸ¤'}
                    </button>
                    <div class="name-text">${nameData.fullName}</div>
                    <div class="name-score">${nameData.score}åˆ†</div>
                    <div class="name-meaning">${nameData.meaning}</div>
                `;

                nameCard.onclick = (e) => {
                    if (!e.target.classList.contains('favorite-btn')) {
                        selectName(nameCard, nameData);
                    }
                };

                resultsContainer.appendChild(nameCard);
            });

            emptyState.style.display = 'none';
            resultsContainer.style.display = 'grid';

            // å­˜å‚¨å½“å‰ç”Ÿæˆçš„åå­—æ•°æ®
            window.currentNames = names;
        }

        function selectName(cardElement, nameData) {
            // ç§»é™¤ä¹‹å‰é€‰ä¸­çš„çŠ¶æ€
            if (selectedNameCard) {
                selectedNameCard.classList.remove('selected');
            }

            // è®¾ç½®æ–°çš„é€‰ä¸­çŠ¶æ€
            cardElement.classList.add('selected');
            selectedNameCard = cardElement;

            // æ˜¾ç¤ºè¯¦ç»†åˆ†æ
            showNameAnalysis(nameData);
        }

        function showNameAnalysis(nameData) {
            const analysisContent = document.getElementById('analysisContent');

            // æ›´æ–°è¯„åˆ†
            document.getElementById('totalScore').textContent = nameData.analysis.total + 'åˆ†';
            document.getElementById('soundScore').textContent = nameData.analysis.sound + 'åˆ†';
            document.getElementById('meaningScore').textContent = nameData.analysis.meaning + 'åˆ†';
            document.getElementById('elementScore').textContent = nameData.analysis.element + 'åˆ†';

            // æ›´æ–°è¿›åº¦æ¡
            document.getElementById('totalProgress').style.width = nameData.analysis.total + '%';
            document.getElementById('soundProgress').style.width = nameData.analysis.sound + '%';
            document.getElementById('meaningProgress').style.width = nameData.analysis.meaning + '%';
            document.getElementById('elementProgress').style.width = nameData.analysis.element + '%';

            // æ›´æ–°é‡Šä¹‰
            const explanation = generateDetailedExplanation(nameData);
            document.getElementById('nameExplanation').innerHTML = explanation;

            analysisContent.classList.add('active');
        }

        function generateDetailedExplanation(nameData) {
            return `
                <h5 style="color: #667eea; margin-bottom: 10px;">${nameData.fullName}</h5>
                <p style="margin-bottom: 15px;"><strong>å¯“æ„ï¼š</strong>${nameData.meaning}</p>
                <p style="margin-bottom: 15px;"><strong>éŸ³å¾‹åˆ†æï¼š</strong>å£°è°ƒæ­é…å’Œè°ï¼Œæœ—æœ—ä¸Šå£ï¼Œæ˜“äºè®°å¿†å’Œä¼ æ’­ã€‚</p>
                <p style="margin-bottom: 15px;"><strong>æ–‡åŒ–å†…æ¶µï¼š</strong>åå­—è•´å«æ·±åšçš„æ–‡åŒ–åº•è•´ï¼Œä½“ç°äº†ä¸­åä¼ ç»Ÿæ–‡åŒ–çš„æ™ºæ…§ã€‚</p>
                <p><strong>å»ºè®®ï¼š</strong>è¿™æ˜¯ä¸€ä¸ªå¯“æ„ç¾å¥½ã€éŸ³å¾‹ä¼˜ç¾çš„åå­—ï¼Œé€‚åˆä½œä¸ºæ­£å¼å§“åä½¿ç”¨ã€‚</p>
            `;
        }

        function toggleFavorite(event, index) {
            event.stopPropagation();

            if (!window.currentNames) return;

            const nameData = window.currentNames[index];
            const favoriteBtn = event.target;

            const existingIndex = favorites.findIndex(fav => fav.fullName === nameData.fullName);

            if (existingIndex > -1) {
                // ç§»é™¤æ”¶è—
                favorites.splice(existingIndex, 1);
                favoriteBtn.textContent = 'ğŸ¤';
                favoriteBtn.classList.remove('favorited');
            } else {
                // æ·»åŠ æ”¶è—
                favorites.push(nameData);
                favoriteBtn.textContent = 'â¤ï¸';
                favoriteBtn.classList.add('favorited');
            }

            localStorage.setItem('favoriteNames', JSON.stringify(favorites));
            updateFavoritesDisplay();
        }

        function updateFavoritesDisplay() {
            const favoritesGrid = document.getElementById('favoritesGrid');
            const favoritesEmpty = document.getElementById('favoritesEmpty');

            if (favorites.length === 0) {
                favoritesEmpty.style.display = 'block';
                favoritesGrid.style.display = 'none';
                return;
            }

            favoritesEmpty.style.display = 'none';
            favoritesGrid.style.display = 'grid';

            favoritesGrid.innerHTML = '';

            favorites.forEach((nameData, index) => {
                const favoriteItem = document.createElement('div');
                favoriteItem.className = 'favorite-item';
                favoriteItem.innerHTML = `
                    <button class="remove-favorite" onclick="removeFavorite(${index})">Ã—</button>
                    <div class="favorite-name">${nameData.fullName}</div>
                    <div style="font-size: 0.9rem; color: #666; margin-top: 5px;">${nameData.score}åˆ†</div>
                `;

                favoriteItem.onclick = () => {
                    if (window.currentNames) {
                        const matchingCard = document.querySelector(`[data-index]`);
                        if (matchingCard) {
                            selectName(matchingCard, nameData);
                        }
                    }
                    showNameAnalysis(nameData);
                };

                favoritesGrid.appendChild(favoriteItem);
            });
        }

        function removeFavorite(index) {
            favorites.splice(index, 1);
            localStorage.setItem('favoriteNames', JSON.stringify(favorites));
            updateFavoritesDisplay();

            // æ›´æ–°å½“å‰æ˜¾ç¤ºçš„æ”¶è—çŠ¶æ€
            if (window.currentNames) {
                const nameCards = document.querySelectorAll('.name-card');
                nameCards.forEach(card => {
                    const favoriteBtn = card.querySelector('.favorite-btn');
                    const nameText = card.querySelector('.name-text').textContent;
                    const isFavorited = favorites.some(fav => fav.fullName === nameText);

                    favoriteBtn.textContent = isFavorited ? 'â¤ï¸' : 'ğŸ¤';
                    favoriteBtn.classList.toggle('favorited', isFavorited);
                });
            }
        }

        function showLoading() {
            document.getElementById('loadingState').style.display = 'block';
            document.getElementById('emptyState').style.display = 'none';
            document.getElementById('nameResults').style.display = 'none';
        }

        function hideLoading() {
            document.getElementById('loadingState').style.display = 'none';
        }

        // è‡ªåŠ¨æ›´æ–°ç”Ÿè‚–
        document.getElementById('birthYear').addEventListener('change', function() {
            const year = this.value;
            const zodiacSelect = document.getElementById('zodiac');

            if (year && zodiacYears[year]) {
                zodiacSelect.value = zodiacYears[year];
            }
        });
    </script>
</body>
</html>